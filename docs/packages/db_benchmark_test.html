<!DOCTYPE html>
<!--
 Copyright 2022 Red Hat, Inc

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
-->

<html>
<head>
<title>db_benchmark_test.go</title>
<meta charset="utf-8"/>
<style type="text/css">body {
    background: rgb(225, 225, 225);
    margin: 0px;
    padding: 0px;
}

#docgo p {
    margin-top: 0px;
    margin-right: 0px;
    margin-bottom: 15px;
    margin-left: 0px;
}

#docgo div {
    display: inline;
}

#docgo #background {
    position: fixed;
    top: 0; left: 525px; right: 0; bottom: 0;
    background: rgb(47, 47, 47);
    border-left: 1px solid #e5e5ee;
    z-index: -1;
}

#docgo .keyword {
    color: rgb(250, 200, 100);
}

#docgo .literal {
    color: rgb(140, 190, 100);
}

#docgo .ident {
    color: white;
}

#docgo .operator {
    color: white;
}

#docgo .comment {
}

#docgo h1, h2, h3, h4, h5 {
    text-align: left;
    margin-top: 0px;
    margin-right: 0px;
    margin-bottom: 15px;
    margin-left: 0px;
}

#docgo h1 {
    margin-top: 40px;
}

#docgo .doc {
    vertical-align: top;
    font-family: 'Palatino Linotype', 'Book Antiqua', Palatino, FreeSerif, serif;
    font-size: 15px;
    line-height: 22px;
    color: black;
    min-width: 450px;
    max-width: 450px;
    padding-top: 10px;
    padding-right: 25px;
    padding-bottom: 1px;
    padding-left: 50px;
    overflow-x: hidden;
}

#docgo .code {
    min-width: 650px;
    max-width: 650px;
    padding-left: 25px;
    padding-right: 15px;
    border-left: 1px;
    overflow-x: hidden;
    vertical-align: top;
}

#docgo .code pre code  {
    font-size: 12px;
    line-height: 18px;
    font-family: Menlo, Monaco, Consolas, "Lucida Console", monospace;
    color: rgb(120, 120, 120);
}
</style>
</head>
<body>
<div id="docgo">
  <div id="background"></div>
  <table>
    <thead><tr><th class="doc"><h1>db_benchmark_test.go</h1></th><th class="code"></th></tr></thead>
    <tbody>
      
      <tr class="section">
	<td class="doc"></td>
	<td class="code"><pre><code><div class="comment">/*
Copyright Â© 2022 Red Hat, Inc.

Licensed under the Apache License, Version 2.0 (the &#34;License&#34;);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an &#34;AS IS&#34; BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/</div>

<div class="keyword">package</div> <div class="ident">main_test</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>Benchmark for storage backend - the Postgres or RDS</p>

<p>Please note that database schema needs to be prepared before benchmarks and
needs to be migrated to latest version.</p>

<p>Look into README.md for detailed information how to check DB status and how
to migrate the database.</p>

<p>Additional info about benchmarks can be found at
https://redhatinsights.github.io/ccx-notification-writer/benchmarks.html</p>

<p>Benchmarks use reports represented as JSON files that are stored in
tests/reports/ subdirectory.</p>

<p>Documentation in literate-programming-style is available at:
https://redhatinsights.github.io/ccx-notification-writer/packages/db<em>benchmark</em>test.html</p>
</td>
	<td class="code"><pre><code>
<div class="keyword">import</div> <div class="operator">(</div>
	<div class="literal">&#34;flag&#34;</div><div class="operator"></div>
	<div class="literal">&#34;fmt&#34;</div><div class="operator"></div>
	<div class="literal">&#34;os&#34;</div><div class="operator"></div>
	<div class="literal">&#34;strconv&#34;</div><div class="operator"></div>
	<div class="literal">&#34;strings&#34;</div><div class="operator"></div>
	<div class="literal">&#34;testing&#34;</div><div class="operator"></div>
	<div class="literal">&#34;time&#34;</div><div class="operator"></div>

	<div class="literal">&#34;database/sql&#34;</div><div class="operator"></div>

	<div class="literal">&#34;github.com/google/uuid&#34;</div><div class="operator"></div>
	<div class="literal">&#34;github.com/rs/zerolog&#34;</div><div class="operator"></div>
	<div class="literal">&#34;github.com/rs/zerolog/log&#34;</div><div class="operator"></div>

	<div class="ident">main</div> <div class="literal">&#34;github.com/RedHatInsights/ccx-notification-writer&#34;</div><div class="operator"></div>
<div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>Configuration-related constants</p>
</td>
	<td class="code"><pre><code><div class="keyword">const</div> <div class="operator">(</div>
	<div class="ident">configFileEnvName</div> <div class="operator">=</div> <div class="literal">&#34;CCX_NOTIFICATION_WRITER_CONFIG_FILE&#34;</div><div class="operator"></div>
	<div class="ident">configFileName</div>    <div class="operator">=</div> <div class="literal">&#34;tests/benchmark&#34;</div><div class="operator"></div>
	<div class="ident">reportDirectory</div>   <div class="operator">=</div> <div class="literal">&#34;tests/reports/&#34;</div><div class="operator"></div>
<div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>JSON files containing reports</p>
</td>
	<td class="code"><pre><code><div class="keyword">const</div> <div class="operator">(</div>
	<div class="ident">reportWithAnalysisMetadataOnlyInJSON</div> <div class="operator">=</div> <div class="literal">&#34;analysis_metadata_only.json&#34;</div><div class="operator"></div>
	<div class="ident">smallReportInJSON</div>                    <div class="operator">=</div> <div class="literal">&#34;small_size.json&#34;</div><div class="operator"></div>
	<div class="ident">middleReportInJSON</div>                   <div class="operator">=</div> <div class="literal">&#34;middle_size.json&#34;</div><div class="operator"></div>
	<div class="ident">largeReportInJSON</div>                    <div class="operator">=</div> <div class="literal">&#34;large_size.json&#34;</div><div class="operator"></div>
<div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>SQL statements</p>

<p>Table reported V1 is reported table without event<em>type column and constraint for this column
Table reported V2 is reported table with event</em>type column and constraint for this column</p>
</td>
	<td class="code"><pre><code><div class="keyword">const</div> <div class="operator">(</div>
	<div class="ident">noOpStatement</div> <div class="operator">=</div> <div class="literal">``</div><div class="operator"></div>

	<div class="ident">dropTableReportedV1</div> <div class="operator">=</div> <div class="literal">`DROP TABLE IF EXISTS reported_benchmark_1;`</div><div class="operator"></div>
	<div class="ident">dropTableReportedV2</div> <div class="operator">=</div> <div class="literal">`DROP TABLE IF EXISTS reported_benchmark_2;`</div><div class="operator"></div>

	<div class="ident">createTableReportedV1</div> <div class="operator">=</div> <div class="literal">`
                CREATE TABLE IF NOT EXISTS reported_benchmark_1 (
                    org_id            integer not null,
                    account_number    integer not null,
                    cluster           character(36) not null,
                    notification_type integer not null,
                    state             integer not null,
                    report            varchar not null,
                    updated_at        timestamp not null,
                    notified_at       timestamp not null,
		    error_log         varchar,
                
                    PRIMARY KEY (org_id, cluster, notified_at),
                    CONSTRAINT fk_notification_type
                        foreign key(notification_type)
                        references notification_types(id),
                    CONSTRAINT fk_state
                        foreign key (state)
                        references states(id)
                );`</div><div class="operator"></div>

	<div class="ident">createTableReportedV2</div> <div class="operator">=</div> <div class="literal">`
                CREATE TABLE IF NOT EXISTS reported_benchmark_2 (
                    org_id            integer not null,
                    account_number    integer not null,
                    cluster           character(36) not null,
                    notification_type integer not null,
                    state             integer not null,
                    report            varchar not null,
                    updated_at        timestamp not null,
                    notified_at       timestamp not null,
		    error_log         varchar,
		    event_type_id     integer,
                
                    PRIMARY KEY (org_id, cluster, notified_at),
                    CONSTRAINT fk_notification_type
                        foreign key(notification_type)
                        references notification_types(id),
                    CONSTRAINT fk_state
                        foreign key (state)
                        references states(id),
		    CONSTRAINT fk_event_type
		        foreign key (event_type_id)
			references event_targets(id)
                );`</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>Index for the reported table used in benchmarks for
notified_at column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">createIndexReportedNotifiedAtDescV1</div> <div class="operator">=</div> <div class="literal">`
                CREATE INDEX IF NOT EXISTS notified_at_desc_idx
		    ON reported_benchmark_1
		 USING btree (notified_at DESC);
        `</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>Index for the reported table used in benchmarks for
notified_at column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">createIndexReportedNotifiedAtDescV2</div> <div class="operator">=</div> <div class="literal">`
                CREATE INDEX IF NOT EXISTS notified_at_desc_idx
		    ON reported_benchmark_2
		 USING btree (notified_at DESC);
        `</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>Index for the reported table for updated<em>at</em>desc column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">createIndexReportedUpdatedAtAscV1</div> <div class="operator">=</div> <div class="literal">`
                CREATE INDEX IF NOT EXISTS updated_at_desc_idx
		    ON reported_benchmark_1
		 USING btree (updated_at ASC);
        `</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>Index for the reported table for updated<em>at</em>desc column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">createIndexReportedUpdatedAtAscV2</div> <div class="operator">=</div> <div class="literal">`
                CREATE INDEX IF NOT EXISTS updated_at_desc_idx
		    ON reported_benchmark_2
		 USING btree (updated_at ASC);
        `</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>Optional index for the reported table for event<em>type</em>id
column. Index type is set to BTree.
(https://www.postgresql.org/docs/current/indexes-types.html for more info)</p>
</td>
	<td class="code"><pre><code>	<div class="ident">createIndexReportedEventTypeBtreeV2</div> <div class="operator">=</div> <div class="literal">`
                CREATE INDEX IF NOT EXISTS event_type_idx
		    ON reported_benchmark_2
		 USING btree (event_type_id ASC);
        `</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>Optional index for the reported table for event<em>type</em>id
column. Index type is set to hash.
(https://www.postgresql.org/docs/current/indexes-types.html for more info)</p>
</td>
	<td class="code"><pre><code>	<div class="ident">createIndexReportedEventTypeHashV2</div> <div class="operator">=</div> <div class="literal">`
                CREATE INDEX IF NOT EXISTS event_type_idx
		    ON reported_benchmark_2
		 USING hash (event_type_id);
        `</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>Optional index for the reported table
column. Index type is set to BRIN.
(https://www.postgresql.org/docs/current/indexes-types.html for more info)</p>
</td>
	<td class="code"><pre><code>	<div class="ident">createIndexReportedEventTypeBrinV2</div> <div class="operator">=</div> <div class="literal">`
                CREATE INDEX IF NOT EXISTS event_type_idx
		    ON reported_benchmark_2
		 USING brin (event_type_id);
        `</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>Insert one record into reported table w/o event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">insertIntoReportedV1Statement</div> <div class="operator">=</div> <div class="literal">`
            INSERT INTO reported_benchmark_1
            (org_id, account_number, cluster, notification_type, state, report, updated_at, notified_at, error_log)
            VALUES
            ($1, $2, $3, $4, $5, $6, $7, $8, $9)
	`</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>Insert one record into reported table with event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">insertIntoReportedV2Statement</div> <div class="operator">=</div> <div class="literal">`
            INSERT INTO reported_benchmark_2
            (org_id, account_number, cluster, notification_type, state, report, updated_at, notified_at, error_log, event_type_id)
            VALUES
            ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10)
	`</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>SQL query used to display older records from reported table</p>
</td>
	<td class="code"><pre><code>	<div class="ident">displayOldRecordsFromReportedTableV1</div> <div class="operator">=</div> <div class="literal">`
                SELECT org_id, account_number, cluster, updated_at, 0
                  FROM reported_benchmark_1
                 WHERE updated_at &lt; NOW() - $1::INTERVAL
                 ORDER BY updated_at
        `</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>SQL query used to display older records from reported table</p>
</td>
	<td class="code"><pre><code>	<div class="ident">displayOldRecordsFromReportedTableV2</div> <div class="operator">=</div> <div class="literal">`
                SELECT org_id, account_number, cluster, updated_at, 0
                  FROM reported_benchmark_2
                 WHERE updated_at &lt; NOW() - $1::INTERVAL
                 ORDER BY updated_at
        `</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>SQL query used to display older records from reported table</p>
</td>
	<td class="code"><pre><code>	<div class="ident">deleteOldRecordsFromReportedTableV1</div> <div class="operator">=</div> <div class="literal">`
                DELETE
                  FROM reported_benchmark_1
                 WHERE updated_at &lt; NOW() - $1::INTERVAL
        `</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>SQL query used to display older records from reported table</p>
</td>
	<td class="code"><pre><code>	<div class="ident">deleteOldRecordsFromReportedTableV2</div> <div class="operator">=</div> <div class="literal">`
                DELETE
                  FROM reported_benchmark_2
                 WHERE updated_at &lt; NOW() - $1::INTERVAL
        `</div><div class="operator"></div>
<div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>insertIntoReportedFunc type represents any function to be called to insert
records into reported table</p>
</td>
	<td class="code"><pre><code><div class="keyword">type</div> <div class="ident">insertIntoReportedFunc</div> <div class="keyword">func</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">,</div> <div class="ident">connection</div> <div class="operator">*</div><div class="ident">sql</div><div class="operator">.</div><div class="ident">DB</div><div class="operator">,</div> <div class="ident">i</div> <div class="ident">int</div><div class="operator">,</div> <div class="ident">report</div> <div class="operator">*</div><div class="ident">string</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>CLI flags that can be provided
(please note that in tests it is NOT NEEDED to parse flags)</p>
</td>
	<td class="code"><pre><code><div class="keyword">var</div> <div class="ident">minReportsParam</div> <div class="operator">=</div> <div class="ident">flag</div><div class="operator">.</div><div class="ident">Int</div><div class="operator">(</div><div class="literal">&#34;min-reports&#34;</div><div class="operator">,</div> <div class="literal">1</div><div class="operator">,</div> <div class="literal">&#34;minimal number of reports to be inserted into database (inclusive)&#34;</div><div class="operator">)</div><div class="operator"></div>
<div class="keyword">var</div> <div class="ident">maxReportsParam</div> <div class="operator">=</div> <div class="ident">flag</div><div class="operator">.</div><div class="ident">Int</div><div class="operator">(</div><div class="literal">&#34;max-reports&#34;</div><div class="operator">,</div> <div class="literal">10</div><div class="operator">,</div> <div class="literal">&#34;maximal number of reports to be inserted into database (exclusive)&#34;</div><div class="operator">)</div><div class="operator"></div>
<div class="keyword">var</div> <div class="ident">reportsStepParam</div> <div class="operator">=</div> <div class="ident">flag</div><div class="operator">.</div><div class="ident">Int</div><div class="operator">(</div><div class="literal">&#34;reports-step&#34;</div><div class="operator">,</div> <div class="literal">1</div><div class="operator">,</div> <div class="literal">&#34;steps between consecutive reports count&#34;</div><div class="operator">)</div><div class="operator"></div>
<div class="keyword">var</div> <div class="ident">reportsCountParam</div> <div class="operator">=</div> <div class="ident">flag</div><div class="operator">.</div><div class="ident">String</div><div class="operator">(</div><div class="literal">&#34;reports-count&#34;</div><div class="operator">,</div> <div class="literal">&#34;&#34;</div><div class="operator">,</div> <div class="literal">&#34;explicit reports count&#34;</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>initLogging function initializes logging that's used internally by functions
from github.com/RedHatInsights/ccx-notification-writer package</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">initLogging</div><div class="operator">(</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="ident">log</div><div class="operator">.</div><div class="ident">Logger</div> <div class="operator">=</div> <div class="ident">log</div><div class="operator">.</div><div class="ident">Output</div><div class="operator">(</div><div class="ident">zerolog</div><div class="operator">.</div><div class="ident">ConsoleWriter</div><div class="operator">{</div><div class="ident">Out</div><div class="operator">:</div> <div class="ident">os</div><div class="operator">.</div><div class="ident">Stderr</div><div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>loadConfiguration function loads configuration prepared to be used by
benchmarks</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">loadConfiguration</div><div class="operator">(</div><div class="operator">)</div> <div class="operator">(</div><div class="ident">main</div><div class="operator">.</div><div class="ident">ConfigStruct</div><div class="operator">,</div> <div class="ident">error</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="ident">os</div><div class="operator">.</div><div class="ident">Clearenv</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">os</div><div class="operator">.</div><div class="ident">Setenv</div><div class="operator">(</div><div class="ident">configFileEnvName</div><div class="operator">,</div> <div class="ident">configFileName</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">if</div> <div class="ident">err</div> <div class="operator">!=</div> <div class="ident">nil</div> <div class="operator">{</div>
		<div class="keyword">return</div> <div class="ident">main</div><div class="operator">.</div><div class="ident">ConfigStruct</div><div class="operator">{</div><div class="operator">}</div><div class="operator">,</div> <div class="ident">err</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>

	<div class="ident">config</div><div class="operator">,</div> <div class="ident">err</div> <div class="operator">:=</div> <div class="ident">main</div><div class="operator">.</div><div class="ident">LoadConfiguration</div><div class="operator">(</div><div class="ident">configFileEnvName</div><div class="operator">,</div> <div class="ident">configFileName</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">if</div> <div class="ident">err</div> <div class="operator">!=</div> <div class="ident">nil</div> <div class="operator">{</div>
		<div class="keyword">return</div> <div class="ident">main</div><div class="operator">.</div><div class="ident">ConfigStruct</div><div class="operator">{</div><div class="operator">}</div><div class="operator">,</div> <div class="ident">err</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>

	<div class="keyword">return</div> <div class="ident">config</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>initializeStorage function initializes storage and perform connection to
database</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">initializeStorage</div><div class="operator">(</div><div class="ident">configuration</div> <div class="ident">main</div><div class="operator">.</div><div class="ident">ConfigStruct</div><div class="operator">)</div> <div class="operator">(</div><div class="operator">*</div><div class="ident">sql</div><div class="operator">.</div><div class="ident">DB</div><div class="operator">,</div> <div class="ident">error</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="ident">storageConfiguration</div> <div class="operator">:=</div> <div class="ident">main</div><div class="operator">.</div><div class="ident">GetStorageConfiguration</div><div class="operator">(</div><div class="ident">configuration</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>perform storage initialization</p>
</td>
	<td class="code"><pre><code>	<div class="ident">storage</div><div class="operator">,</div> <div class="ident">err</div> <div class="operator">:=</div> <div class="ident">main</div><div class="operator">.</div><div class="ident">NewStorage</div><div class="operator">(</div><div class="ident">storageConfiguration</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">if</div> <div class="ident">err</div> <div class="operator">!=</div> <div class="ident">nil</div> <div class="operator">{</div>
		<div class="keyword">return</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">err</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>for benchmarks, we just need to have connection to DB, not the whole
Storage structure</p>
</td>
	<td class="code"><pre><code>	<div class="ident">connection</div> <div class="operator">:=</div> <div class="ident">storage</div><div class="operator">.</div><div class="ident">Connection</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>check if connection has been established</p>
</td>
	<td class="code"><pre><code>	<div class="keyword">if</div> <div class="ident">storage</div><div class="operator">.</div><div class="ident">Connection</div><div class="operator">(</div><div class="operator">)</div> <div class="operator">==</div> <div class="ident">nil</div> <div class="operator">{</div>
		<div class="keyword">return</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">err</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>connection should be established at this moment</p>
</td>
	<td class="code"><pre><code>	<div class="keyword">return</div> <div class="ident">connection</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>unfortunatelly there seems to be no other way how to handle per-benchmark
setup properly than to use global variables</p>
</td>
	<td class="code"><pre><code><div class="keyword">var</div> <div class="ident">connection</div> <div class="operator">*</div><div class="ident">sql</div><div class="operator">.</div><div class="ident">DB</div><div class="operator"></div>
<div class="keyword">var</div> <div class="ident">initialized</div> <div class="ident">bool</div> <div class="operator">=</div> <div class="ident">false</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>setup function performs all DB initializations needed for DB benchmarks. Can
be called from any benchmark. In case of any error detected, benchmarks fail
immediatelly.</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">setup</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">*</div><div class="ident">sql</div><div class="operator">.</div><div class="ident">DB</div> <div class="operator">{</div>
	<div class="keyword">if</div> <div class="ident">initialized</div> <div class="operator">{</div>
		<div class="keyword">return</div> <div class="ident">connection</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>

	<div class="ident">initLogging</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">configuration</div><div class="operator">,</div> <div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadConfiguration</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">if</div> <div class="ident">err</div> <div class="operator">!=</div> <div class="ident">nil</div> <div class="operator">{</div>
		<div class="ident">b</div><div class="operator">.</div><div class="ident">Fatal</div><div class="operator">(</div><div class="ident">err</div><div class="operator">)</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>

	<div class="ident">connection</div><div class="operator">,</div> <div class="ident">err</div> <div class="operator">=</div> <div class="ident">initializeStorage</div><div class="operator">(</div><div class="ident">configuration</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">if</div> <div class="ident">err</div> <div class="operator">!=</div> <div class="ident">nil</div> <div class="operator">{</div>
		<div class="ident">b</div><div class="operator">.</div><div class="ident">Fatal</div><div class="operator">(</div><div class="ident">err</div><div class="operator">)</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>next time, benchmarks will use already established connection to
database</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initialized</div> <div class="operator">=</div> <div class="ident">true</div><div class="operator"></div>

	<div class="keyword">return</div> <div class="ident">connection</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>execSQLStatement function executes any provided SQL statement. In case of
any error detected, benchmarks fail immediatelly.</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">execSQLStatement</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">,</div> <div class="ident">connection</div> <div class="operator">*</div><div class="ident">sql</div><div class="operator">.</div><div class="ident">DB</div><div class="operator">,</div> <div class="ident">statement</div> <div class="ident">string</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="ident">_</div><div class="operator">,</div> <div class="ident">err</div> <div class="operator">:=</div> <div class="ident">connection</div><div class="operator">.</div><div class="ident">Exec</div><div class="operator">(</div><div class="ident">statement</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>check for any error, possible to exit immediatelly</p>
</td>
	<td class="code"><pre><code>	<div class="keyword">if</div> <div class="ident">err</div> <div class="operator">!=</div> <div class="ident">nil</div> <div class="operator">{</div>
		<div class="ident">b</div><div class="operator">.</div><div class="ident">Fatal</div><div class="operator">(</div><div class="ident">err</div><div class="operator">)</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>insertIntoReportedV1Statement function inserts one new record into reported
table v1. In case of any error detected, benchmarks fail immediatelly.</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">insertIntoReportedV1</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">,</div> <div class="ident">connection</div> <div class="operator">*</div><div class="ident">sql</div><div class="operator">.</div><div class="ident">DB</div><div class="operator">,</div> <div class="ident">i</div> <div class="ident">int</div><div class="operator">,</div> <div class="ident">report</div> <div class="operator">*</div><div class="ident">string</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>following columns needs to be updated with data:
1 | org<em>id            | integer                     | not null  |
2 | account</em>number    | integer                     | not null  |
3 | cluster           | character(36)               | not null  |
4 | notification<em>type | integer                     | not null  |
5 | state             | integer                     | not null  |
6 | report            | character varying           | not null  |
7 | updated</em>at        | timestamp without time zone | not null  |
8 | notified<em>at       | timestamp without time zone | not null  |
9 | error</em>log         | character varying           |           |</p>
</td>
	<td class="code"><pre><code>
	<div class="ident">orgID</div> <div class="operator">:=</div> <div class="ident">i</div> <div class="operator">%</div> <div class="literal">1000</div>                  <div class="operator"></div><div class="comment">// limited number of org IDs</div>
	<div class="ident">accountNumber</div> <div class="operator">:=</div> <div class="ident">orgID</div> <div class="operator">&#43;</div> <div class="literal">1</div>         <div class="operator"></div><div class="comment">// can be different than org ID</div>
	<div class="ident">clusterName</div> <div class="operator">:=</div> <div class="ident">uuid</div><div class="operator">.</div><div class="ident">New</div><div class="operator">(</div><div class="operator">)</div><div class="operator">.</div><div class="ident">String</div><div class="operator">(</div><div class="operator">)</div> <div class="operator"></div><div class="comment">// unique</div>
	<div class="ident">notificationTypeID</div> <div class="operator">:=</div> <div class="literal">1</div>            <div class="operator"></div><div class="comment">// instant report</div>
	<div class="ident">stateID</div> <div class="operator">:=</div> <div class="literal">1</div> <div class="operator">&#43;</div> <div class="ident">i</div><div class="operator">%</div><div class="literal">4</div>                 <div class="operator"></div><div class="comment">// just four states can be used</div>
	<div class="ident">updatedAt</div> <div class="operator">:=</div> <div class="ident">time</div><div class="operator">.</div><div class="ident">Now</div><div class="operator">(</div><div class="operator">)</div>            <div class="operator"></div><div class="comment">// don&#39;t have to be unique</div>
	<div class="ident">notifiedAt</div> <div class="operator">:=</div> <div class="ident">time</div><div class="operator">.</div><div class="ident">Now</div><div class="operator">(</div><div class="operator">)</div>           <div class="operator"></div><div class="comment">// don&#39;t have to be unique</div>
	<div class="ident">errorLog</div> <div class="operator">:=</div> <div class="literal">&#34;&#34;</div>                     <div class="operator"></div><div class="comment">// usually empty</div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>perform insert</p>
</td>
	<td class="code"><pre><code>	<div class="ident">_</div><div class="operator">,</div> <div class="ident">err</div> <div class="operator">:=</div> <div class="ident">connection</div><div class="operator">.</div><div class="ident">Exec</div><div class="operator">(</div><div class="ident">insertIntoReportedV1Statement</div><div class="operator">,</div> <div class="ident">orgID</div><div class="operator">,</div>
		<div class="ident">accountNumber</div><div class="operator">,</div> <div class="ident">clusterName</div><div class="operator">,</div> <div class="ident">notificationTypeID</div><div class="operator">,</div> <div class="ident">stateID</div><div class="operator">,</div>
		<div class="ident">report</div><div class="operator">,</div> <div class="ident">updatedAt</div><div class="operator">,</div> <div class="ident">notifiedAt</div><div class="operator">,</div> <div class="ident">errorLog</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>check for any error, possible to exit immediatelly</p>
</td>
	<td class="code"><pre><code>	<div class="keyword">if</div> <div class="ident">err</div> <div class="operator">!=</div> <div class="ident">nil</div> <div class="operator">{</div>
		<div class="ident">b</div><div class="operator">.</div><div class="ident">Fatal</div><div class="operator">(</div><div class="ident">err</div><div class="operator">)</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>insertIntoReportedV2Statement function inserts one new record into reported
table v2. In case of any error detected, benchmarks fail immediatelly.</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">insertIntoReportedV2</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">,</div> <div class="ident">connection</div> <div class="operator">*</div><div class="ident">sql</div><div class="operator">.</div><div class="ident">DB</div><div class="operator">,</div> <div class="ident">i</div> <div class="ident">int</div><div class="operator">,</div> <div class="ident">report</div> <div class="operator">*</div><div class="ident">string</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>following columns needs to be updated with data:
1 | org<em>id            | integer                     | not null  |
2 | account</em>number    | integer                     | not null  |
3 | cluster           | character(36)               | not null  |
4 | notification<em>type | integer                     | not null  |
5 | state             | integer                     | not null  |
6 | report            | character varying           | not null  |
7 | updated</em>at        | timestamp without time zone | not null  |
8 | notified<em>at       | timestamp without time zone | not null  |
9 | error</em>log         | character varying           |           |
10| event<em>type</em>id     | integer                     |           |</p>
</td>
	<td class="code"><pre><code>
	<div class="ident">orgID</div> <div class="operator">:=</div> <div class="ident">i</div> <div class="operator">%</div> <div class="literal">1000</div>                  <div class="operator"></div><div class="comment">// limited number of org IDs</div>
	<div class="ident">accountNumber</div> <div class="operator">:=</div> <div class="ident">orgID</div> <div class="operator">&#43;</div> <div class="literal">1</div>         <div class="operator"></div><div class="comment">// can be different than org ID</div>
	<div class="ident">clusterName</div> <div class="operator">:=</div> <div class="ident">uuid</div><div class="operator">.</div><div class="ident">New</div><div class="operator">(</div><div class="operator">)</div><div class="operator">.</div><div class="ident">String</div><div class="operator">(</div><div class="operator">)</div> <div class="operator"></div><div class="comment">// unique</div>
	<div class="ident">notificationTypeID</div> <div class="operator">:=</div> <div class="literal">1</div>            <div class="operator"></div><div class="comment">// instant report</div>
	<div class="ident">stateID</div> <div class="operator">:=</div> <div class="literal">1</div> <div class="operator">&#43;</div> <div class="ident">i</div><div class="operator">%</div><div class="literal">4</div>                 <div class="operator"></div><div class="comment">// just four states can be used</div>
	<div class="ident">updatedAt</div> <div class="operator">:=</div> <div class="ident">time</div><div class="operator">.</div><div class="ident">Now</div><div class="operator">(</div><div class="operator">)</div>            <div class="operator"></div><div class="comment">// don&#39;t have to be unique</div>
	<div class="ident">notifiedAt</div> <div class="operator">:=</div> <div class="ident">time</div><div class="operator">.</div><div class="ident">Now</div><div class="operator">(</div><div class="operator">)</div>           <div class="operator"></div><div class="comment">// don&#39;t have to be unique</div>
	<div class="ident">errorLog</div> <div class="operator">:=</div> <div class="literal">&#34;&#34;</div>                     <div class="operator"></div><div class="comment">// usually empty</div>
	<div class="ident">eventTypeID</div> <div class="operator">:=</div> <div class="ident">i</div><div class="operator">%</div><div class="literal">2</div> <div class="operator">&#43;</div> <div class="literal">1</div>             <div class="operator"></div><div class="comment">// just two event type targets possible</div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>perform insert</p>
</td>
	<td class="code"><pre><code>	<div class="ident">_</div><div class="operator">,</div> <div class="ident">err</div> <div class="operator">:=</div> <div class="ident">connection</div><div class="operator">.</div><div class="ident">Exec</div><div class="operator">(</div><div class="ident">insertIntoReportedV2Statement</div><div class="operator">,</div> <div class="ident">orgID</div><div class="operator">,</div>
		<div class="ident">accountNumber</div><div class="operator">,</div> <div class="ident">clusterName</div><div class="operator">,</div> <div class="ident">notificationTypeID</div><div class="operator">,</div> <div class="ident">stateID</div><div class="operator">,</div>
		<div class="ident">report</div><div class="operator">,</div> <div class="ident">updatedAt</div><div class="operator">,</div> <div class="ident">notifiedAt</div><div class="operator">,</div> <div class="ident">errorLog</div><div class="operator">,</div> <div class="ident">eventTypeID</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>check for any error, possible to exit immediatelly</p>
</td>
	<td class="code"><pre><code>	<div class="keyword">if</div> <div class="ident">err</div> <div class="operator">!=</div> <div class="ident">nil</div> <div class="operator">{</div>
		<div class="ident">b</div><div class="operator">.</div><div class="ident">Fatal</div><div class="operator">(</div><div class="ident">err</div><div class="operator">)</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>runBenchmarkInsertIntoReportedTable function perform several inserts into
reported table v1 or v2 (depending on injected function). In case of any
error detected, benchmarks fail immediatelly.</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">runBenchmarkInsertIntoReportedTable</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">,</div> <div class="ident">insertFunction</div> <div class="ident">insertIntoReportedFunc</div><div class="operator">,</div>
	<div class="ident">initStatements</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">,</div> <div class="ident">scaleFactor</div> <div class="ident">int</div><div class="operator">,</div> <div class="ident">report</div> <div class="operator">*</div><div class="ident">string</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>retrieve DB connection</p>
</td>
	<td class="code"><pre><code>	<div class="ident">connection</div> <div class="operator">:=</div> <div class="ident">setup</div><div class="operator">(</div><div class="ident">b</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">if</div> <div class="ident">connection</div> <div class="operator">==</div> <div class="ident">nil</div> <div class="operator">{</div>
		<div class="ident">b</div><div class="operator">.</div><div class="ident">Fatal</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run all init SQL statements</p>
</td>
	<td class="code"><pre><code>	<div class="keyword">for</div> <div class="ident">_</div><div class="operator">,</div> <div class="ident">sqlStatement</div> <div class="operator">:=</div> <div class="keyword">range</div> <div class="ident">initStatements</div> <div class="operator">{</div>
		<div class="ident">execSQLStatement</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">connection</div><div class="operator">,</div> <div class="ident">sqlStatement</div><div class="operator">)</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>good citizens cleanup properly
defer execSQLStatement(b, connection, dropTableReportedV1)</p>
</td>
	<td class="code"><pre><code>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>time to start benchmark</p>
</td>
	<td class="code"><pre><code>	<div class="ident">b</div><div class="operator">.</div><div class="ident">ResetTimer</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>perform DB benchmark</p>
</td>
	<td class="code"><pre><code>	<div class="keyword">for</div> <div class="ident">i</div> <div class="operator">:=</div> <div class="literal">0</div><div class="operator">;</div> <div class="ident">i</div> <div class="operator">&lt;</div> <div class="ident">b</div><div class="operator">.</div><div class="ident">N</div><div class="operator">;</div> <div class="ident">i</div><div class="operator">&#43;&#43;</div> <div class="operator">{</div>
		<div class="keyword">for</div> <div class="ident">j</div> <div class="operator">:=</div> <div class="literal">0</div><div class="operator">;</div> <div class="ident">j</div> <div class="operator">&lt;</div> <div class="ident">scaleFactor</div><div class="operator">;</div> <div class="ident">j</div><div class="operator">&#43;&#43;</div> <div class="operator">{</div>
			<div class="ident">insertFunction</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">connection</div><div class="operator">,</div> <div class="ident">i</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">)</div><div class="operator"></div>
		<div class="operator">}</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>runBenchmarkSelectOrDeleteFromReportedTable function perform several inserts
into reported table v1 or v2 (depending on injected function) and the run
queries or delete statements against such table. In case of any error
detected, benchmarks fail immediatelly.</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">runBenchmarkSelectOrDeleteFromReportedTable</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">,</div> <div class="ident">insertFunction</div> <div class="ident">insertIntoReportedFunc</div><div class="operator">,</div>
	<div class="ident">selectStatement</div> <div class="ident">string</div><div class="operator">,</div> <div class="ident">deleteStatement</div> <div class="ident">string</div><div class="operator">,</div>
	<div class="ident">initStatements</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">,</div> <div class="ident">reportsCount</div> <div class="ident">int</div><div class="operator">,</div> <div class="ident">report</div> <div class="operator">*</div><div class="ident">string</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>retrieve DB connection</p>
</td>
	<td class="code"><pre><code>	<div class="ident">connection</div> <div class="operator">:=</div> <div class="ident">setup</div><div class="operator">(</div><div class="ident">b</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">if</div> <div class="ident">connection</div> <div class="operator">==</div> <div class="ident">nil</div> <div class="operator">{</div>
		<div class="ident">b</div><div class="operator">.</div><div class="ident">Fatal</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run all init SQL statements</p>
</td>
	<td class="code"><pre><code>	<div class="keyword">for</div> <div class="ident">_</div><div class="operator">,</div> <div class="ident">sqlStatement</div> <div class="operator">:=</div> <div class="keyword">range</div> <div class="ident">initStatements</div> <div class="operator">{</div>
		<div class="ident">execSQLStatement</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">connection</div><div class="operator">,</div> <div class="ident">sqlStatement</div><div class="operator">)</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>good citizens cleanup properly
defer execSQLStatement(b, connection, dropTableReportedV1)</p>
</td>
	<td class="code"><pre><code>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>fill-in the table (no part of benchmark, so don't measure time there)</p>
</td>
	<td class="code"><pre><code>	<div class="keyword">for</div> <div class="ident">i</div> <div class="operator">:=</div> <div class="literal">0</div><div class="operator">;</div> <div class="ident">i</div> <div class="operator">&lt;</div> <div class="ident">reportsCount</div><div class="operator">;</div> <div class="ident">i</div><div class="operator">&#43;&#43;</div> <div class="operator">{</div>
		<div class="ident">insertFunction</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">connection</div><div class="operator">,</div> <div class="ident">i</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">)</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>time to start benchmark</p>
</td>
	<td class="code"><pre><code>	<div class="ident">b</div><div class="operator">.</div><div class="ident">ResetTimer</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>perform DB benchmark</p>
</td>
	<td class="code"><pre><code>	<div class="keyword">for</div> <div class="ident">i</div> <div class="operator">:=</div> <div class="literal">0</div><div class="operator">;</div> <div class="ident">i</div> <div class="operator">&lt;</div> <div class="ident">b</div><div class="operator">.</div><div class="ident">N</div><div class="operator">;</div> <div class="ident">i</div><div class="operator">&#43;&#43;</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>perform benchmarks for SELECT statement (query)</p>
</td>
	<td class="code"><pre><code>		<div class="keyword">if</div> <div class="ident">selectStatement</div> <div class="operator">!=</div> <div class="ident">noOpStatement</div> <div class="operator">{</div>
			<div class="ident">rows</div><div class="operator">,</div> <div class="ident">err</div> <div class="operator">:=</div> <div class="ident">connection</div><div class="operator">.</div><div class="ident">Query</div><div class="operator">(</div><div class="ident">selectStatement</div><div class="operator">,</div> <div class="literal">&#34;8 days&#34;</div><div class="operator">)</div><div class="operator"></div>
			<div class="keyword">if</div> <div class="ident">err</div> <div class="operator">!=</div> <div class="ident">nil</div> <div class="operator">{</div>
				<div class="ident">b</div><div class="operator">.</div><div class="ident">Fatal</div><div class="operator">(</div><div class="ident">err</div><div class="operator">)</div><div class="operator"></div>
			<div class="operator">}</div><div class="operator"></div>
			<div class="keyword">if</div> <div class="ident">rows</div> <div class="operator">==</div> <div class="ident">nil</div> <div class="operator">{</div>
				<div class="ident">b</div><div class="operator">.</div><div class="ident">Fatal</div><div class="operator">(</div><div class="literal">&#34;no rows selected&#34;</div><div class="operator">)</div><div class="operator"></div>
			<div class="operator">}</div><div class="operator"></div>

			<div class="ident">err</div> <div class="operator">=</div> <div class="ident">rows</div><div class="operator">.</div><div class="ident">Close</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>
			<div class="keyword">if</div> <div class="ident">err</div> <div class="operator">!=</div> <div class="ident">nil</div> <div class="operator">{</div>
				<div class="ident">b</div><div class="operator">.</div><div class="ident">Fatal</div><div class="operator">(</div><div class="ident">err</div><div class="operator">)</div><div class="operator"></div>
			<div class="operator">}</div><div class="operator"></div>
		<div class="operator">}</div><div class="operator"></div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>perform benchmarks for DELETE statement</p>
</td>
	<td class="code"><pre><code>		<div class="keyword">if</div> <div class="ident">deleteStatement</div> <div class="operator">!=</div> <div class="ident">noOpStatement</div> <div class="operator">{</div>
			<div class="ident">_</div><div class="operator">,</div> <div class="ident">err</div> <div class="operator">:=</div> <div class="ident">connection</div><div class="operator">.</div><div class="ident">Exec</div><div class="operator">(</div><div class="ident">deleteStatement</div><div class="operator">,</div> <div class="literal">&#34;8 days&#34;</div><div class="operator">)</div><div class="operator"></div>
			<div class="keyword">if</div> <div class="ident">err</div> <div class="operator">!=</div> <div class="ident">nil</div> <div class="operator">{</div>
				<div class="ident">b</div><div class="operator">.</div><div class="ident">Fatal</div><div class="operator">(</div><div class="ident">err</div><div class="operator">)</div><div class="operator"></div>
			<div class="operator">}</div><div class="operator"></div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>fill-in the table again (no part of benchmark, so don't measure time there)</p>
</td>
	<td class="code"><pre><code>			<div class="ident">b</div><div class="operator">.</div><div class="ident">StopTimer</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>
			<div class="keyword">for</div> <div class="ident">i</div> <div class="operator">:=</div> <div class="literal">0</div><div class="operator">;</div> <div class="ident">i</div> <div class="operator">&lt;</div> <div class="ident">reportsCount</div><div class="operator">;</div> <div class="ident">i</div><div class="operator">&#43;&#43;</div> <div class="operator">{</div>
				<div class="ident">insertFunction</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">connection</div><div class="operator">,</div> <div class="ident">i</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">)</div><div class="operator"></div>
			<div class="operator">}</div><div class="operator"></div>
			<div class="ident">b</div><div class="operator">.</div><div class="ident">StartTimer</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>
		<div class="operator">}</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>readReport function tries to read report from file. Benchmark will fail in
any error.</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">readReport</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">,</div> <div class="ident">filename</div> <div class="ident">string</div><div class="operator">)</div> <div class="ident">string</div> <div class="operator">{</div>
	<div class="ident">content</div><div class="operator">,</div> <div class="ident">err</div> <div class="operator">:=</div> <div class="ident">os</div><div class="operator">.</div><div class="ident">ReadFile</div><div class="operator">(</div><div class="ident">reportDirectory</div> <div class="operator">&#43;</div> <div class="ident">filename</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">if</div> <div class="ident">err</div> <div class="operator">!=</div> <div class="ident">nil</div> <div class="operator">{</div>
		<div class="ident">b</div><div class="operator">.</div><div class="ident">Fatal</div><div class="operator">(</div><div class="ident">err</div><div class="operator">)</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>
	<div class="keyword">return</div> <div class="ident">string</div><div class="operator">(</div><div class="ident">content</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>getIndicesForReportedTableV1 is helper function to return map with all
possible indices combinations</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">getIndicesForReportedTableV1</div><div class="operator">(</div><div class="operator">)</div> <div class="keyword">map</div><div class="operator">[</div><div class="ident">string</div><div class="operator">]</div><div class="operator">[</div><div class="operator">]</div><div class="ident">string</div> <div class="operator">{</div>
	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">make</div><div class="operator">(</div><div class="keyword">map</div><div class="operator">[</div><div class="ident">string</div><div class="operator">]</div><div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">indices</div><div class="operator">[</div><div class="literal">&#34;no indices]&#34;</div><div class="operator">]</div> <div class="operator">=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div><div class="operator">}</div><div class="operator"></div>

	<div class="ident">indices</div><div class="operator">[</div><div class="literal">&#34;notified_at_desc&#34;</div><div class="operator">]</div> <div class="operator">=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">createIndexReportedNotifiedAtDescV1</div><div class="operator">}</div><div class="operator"></div>

	<div class="ident">indices</div><div class="operator">[</div><div class="literal">&#34;updated_at_asc&#34;</div><div class="operator">]</div> <div class="operator">=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">createIndexReportedUpdatedAtAscV1</div><div class="operator">}</div><div class="operator"></div>

	<div class="ident">indices</div><div class="operator">[</div><div class="literal">&#34;notified_at_desc and updated_at_asc&#34;</div><div class="operator">]</div> <div class="operator">=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">createIndexReportedNotifiedAtDescV1</div><div class="operator">,</div>
		<div class="ident">createIndexReportedUpdatedAtAscV1</div><div class="operator">}</div><div class="operator"></div>

	<div class="keyword">return</div> <div class="ident">indices</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>getIndicesForReportedTableV2 is helper function to return map with all
possible indices combinations</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">getIndicesForReportedTableV2</div><div class="operator">(</div><div class="operator">)</div> <div class="keyword">map</div><div class="operator">[</div><div class="ident">string</div><div class="operator">]</div><div class="operator">[</div><div class="operator">]</div><div class="ident">string</div> <div class="operator">{</div>
	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">make</div><div class="operator">(</div><div class="keyword">map</div><div class="operator">[</div><div class="ident">string</div><div class="operator">]</div><div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">indices</div><div class="operator">[</div><div class="literal">&#34;no indices]&#34;</div><div class="operator">]</div> <div class="operator">=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div><div class="operator">}</div><div class="operator"></div>

	<div class="ident">indices</div><div class="operator">[</div><div class="literal">&#34;notified_at_desc&#34;</div><div class="operator">]</div> <div class="operator">=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">createIndexReportedNotifiedAtDescV2</div><div class="operator">}</div><div class="operator"></div>

	<div class="ident">indices</div><div class="operator">[</div><div class="literal">&#34;updated_at_asc&#34;</div><div class="operator">]</div> <div class="operator">=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">createIndexReportedUpdatedAtAscV2</div><div class="operator">}</div><div class="operator"></div>

	<div class="ident">indices</div><div class="operator">[</div><div class="literal">&#34;notified_at_desc and updated_at_asc&#34;</div><div class="operator">]</div> <div class="operator">=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">createIndexReportedNotifiedAtDescV2</div><div class="operator">,</div>
		<div class="ident">createIndexReportedUpdatedAtAscV2</div><div class="operator">}</div><div class="operator"></div>

	<div class="ident">indices</div><div class="operator">[</div><div class="literal">&#34;notified_at_desc and event_type(BTree)&#34;</div><div class="operator">]</div> <div class="operator">=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">createIndexReportedNotifiedAtDescV2</div><div class="operator">,</div>
		<div class="ident">createIndexReportedEventTypeBtreeV2</div><div class="operator">}</div><div class="operator"></div>

	<div class="ident">indices</div><div class="operator">[</div><div class="literal">&#34;notified_at_desc and event_type(hash)&#34;</div><div class="operator">]</div> <div class="operator">=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">createIndexReportedNotifiedAtDescV2</div><div class="operator">,</div>
		<div class="ident">createIndexReportedEventTypeHashV2</div><div class="operator">}</div><div class="operator"></div>

	<div class="ident">indices</div><div class="operator">[</div><div class="literal">&#34;notified_at_desc and event_type(BRIN)&#34;</div><div class="operator">]</div> <div class="operator">=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">createIndexReportedNotifiedAtDescV2</div><div class="operator">,</div>
		<div class="ident">createIndexReportedEventTypeBrinV2</div><div class="operator">}</div><div class="operator"></div>

	<div class="ident">indices</div><div class="operator">[</div><div class="literal">&#34;updated_at_asc and event_type(BTree)&#34;</div><div class="operator">]</div> <div class="operator">=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">createIndexReportedUpdatedAtAscV2</div><div class="operator">,</div>
		<div class="ident">createIndexReportedEventTypeBtreeV2</div><div class="operator">}</div><div class="operator"></div>

	<div class="ident">indices</div><div class="operator">[</div><div class="literal">&#34;updated_at_asc and event_type(hash)&#34;</div><div class="operator">]</div> <div class="operator">=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">createIndexReportedUpdatedAtAscV2</div><div class="operator">,</div>
		<div class="ident">createIndexReportedEventTypeHashV2</div><div class="operator">}</div><div class="operator"></div>

	<div class="ident">indices</div><div class="operator">[</div><div class="literal">&#34;updated_at_asc and event_type(BRIN)&#34;</div><div class="operator">]</div> <div class="operator">=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">createIndexReportedUpdatedAtAscV2</div><div class="operator">,</div>
		<div class="ident">createIndexReportedEventTypeBrinV2</div><div class="operator">}</div><div class="operator"></div>

	<div class="ident">indices</div><div class="operator">[</div><div class="literal">&#34;notified_at_desc and updated_at_asc and event_type(BTree)&#34;</div><div class="operator">]</div> <div class="operator">=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">createIndexReportedNotifiedAtDescV2</div><div class="operator">,</div>
		<div class="ident">createIndexReportedUpdatedAtAscV2</div><div class="operator">,</div>
		<div class="ident">createIndexReportedEventTypeBtreeV2</div><div class="operator">}</div><div class="operator"></div>

	<div class="ident">indices</div><div class="operator">[</div><div class="literal">&#34;notified_at_desc and updated_at_asc and event_type(hash)&#34;</div><div class="operator">]</div> <div class="operator">=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">createIndexReportedNotifiedAtDescV2</div><div class="operator">,</div>
		<div class="ident">createIndexReportedUpdatedAtAscV2</div><div class="operator">,</div>
		<div class="ident">createIndexReportedEventTypeHashV2</div><div class="operator">}</div><div class="operator"></div>

	<div class="ident">indices</div><div class="operator">[</div><div class="literal">&#34;notified_at_desc and updated_at_asc and event_type(BRIN)&#34;</div><div class="operator">]</div> <div class="operator">=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">createIndexReportedNotifiedAtDescV2</div><div class="operator">,</div>
		<div class="ident">createIndexReportedUpdatedAtAscV2</div><div class="operator">,</div>
		<div class="ident">createIndexReportedEventTypeBrinV2</div><div class="operator">}</div><div class="operator"></div>
	<div class="keyword">return</div> <div class="ident">indices</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>benchmarkInsertReportsIntoReportedTableImpl is an implementation of
benchmark to insert reports into reported table with or without
event<em>type</em>id column. Table with all possible indices combination is tested.</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">benchmarkInsertReportsIntoReportedTableImpl</div><div class="operator">(</div>
	<div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">,</div>
	<div class="ident">insertFunction</div> <div class="ident">insertIntoReportedFunc</div><div class="operator">,</div>
	<div class="ident">initStatements</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">,</div>
	<div class="ident">indices</div> <div class="keyword">map</div><div class="operator">[</div><div class="ident">string</div><div class="operator">]</div><div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">,</div>
	<div class="ident">report</div> <div class="ident">string</div><div class="operator">)</div> <div class="operator">{</div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>try all indices combinations</p>
</td>
	<td class="code"><pre><code>	<div class="keyword">for</div> <div class="ident">description</div><div class="operator">,</div> <div class="ident">indexStatements</div> <div class="operator">:=</div> <div class="keyword">range</div> <div class="ident">indices</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>new benchmark</p>
</td>
	<td class="code"><pre><code>		<div class="ident">b</div><div class="operator">.</div><div class="ident">Run</div><div class="operator">(</div><div class="ident">description</div><div class="operator">,</div> <div class="keyword">func</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>prepare all SQL statements to be run before benchmark</p>
</td>
	<td class="code"><pre><code>			<div class="ident">sqlStatements</div> <div class="operator">:=</div> <div class="ident">make</div><div class="operator">(</div><div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">,</div> <div class="ident">len</div><div class="operator">(</div><div class="ident">initStatements</div><div class="operator">)</div><div class="operator">&#43;</div><div class="ident">len</div><div class="operator">(</div><div class="ident">indexStatements</div><div class="operator">)</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>add all init statements</p>
</td>
	<td class="code"><pre><code>			<div class="ident">sqlStatements</div> <div class="operator">=</div> <div class="ident">append</div><div class="operator">(</div><div class="ident">sqlStatements</div><div class="operator">,</div> <div class="ident">initStatements</div><div class="operator">...</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>add all statements to create indices</p>
</td>
	<td class="code"><pre><code>			<div class="ident">sqlStatements</div> <div class="operator">=</div> <div class="ident">append</div><div class="operator">(</div><div class="ident">sqlStatements</div><div class="operator">,</div> <div class="ident">indexStatements</div><div class="operator">...</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>now everything's ready -&gt; run benchmark</p>
</td>
	<td class="code"><pre><code>			<div class="ident">runBenchmarkInsertIntoReportedTable</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">insertFunction</div><div class="operator">,</div> <div class="ident">sqlStatements</div><div class="operator">,</div> <div class="literal">1</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">report</div><div class="operator">)</div><div class="operator"></div>
		<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>benchmarkSelectOrDeleteOldReportsFromReportedTableImpl is an implementation
of benchmark to query reports from reported or delete reports from such
table with or without event<em>type</em>id column. Table with all possible indices
combination is tested.</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">benchmarkSelectOrDeleteOldReportsFromReportedTableImpl</div><div class="operator">(</div>
	<div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">,</div>
	<div class="ident">insertFunction</div> <div class="ident">insertIntoReportedFunc</div><div class="operator">,</div>
	<div class="ident">selectStatement</div> <div class="ident">string</div><div class="operator">,</div>
	<div class="ident">deleteStatement</div> <div class="ident">string</div><div class="operator">,</div>
	<div class="ident">initStatements</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">,</div>
	<div class="ident">indices</div> <div class="keyword">map</div><div class="operator">[</div><div class="ident">string</div><div class="operator">]</div><div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">,</div>
	<div class="ident">report</div> <div class="ident">string</div><div class="operator">,</div>
	<div class="ident">possibleReportsCount</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">int</div><div class="operator">)</div> <div class="operator">{</div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>try all indices combinations</p>
</td>
	<td class="code"><pre><code>	<div class="keyword">for</div> <div class="ident">description</div><div class="operator">,</div> <div class="ident">indexStatements</div> <div class="operator">:=</div> <div class="keyword">range</div> <div class="ident">indices</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>benchmark with various reports count stored in table</p>
</td>
	<td class="code"><pre><code>		<div class="keyword">for</div> <div class="ident">_</div><div class="operator">,</div> <div class="ident">reportsCount</div> <div class="operator">:=</div> <div class="keyword">range</div> <div class="ident">possibleReportsCount</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>new benchmark</p>
</td>
	<td class="code"><pre><code>			<div class="ident">benchmarkName</div> <div class="operator">:=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="literal">&#34;%s with %d reports&#34;</div><div class="operator">,</div> <div class="ident">description</div><div class="operator">,</div> <div class="ident">reportsCount</div><div class="operator">)</div><div class="operator"></div>
			<div class="ident">b</div><div class="operator">.</div><div class="ident">Run</div><div class="operator">(</div><div class="ident">benchmarkName</div><div class="operator">,</div> <div class="keyword">func</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>prepare all SQL statements to be run before benchmark</p>
</td>
	<td class="code"><pre><code>				<div class="ident">sqlStatements</div> <div class="operator">:=</div> <div class="ident">make</div><div class="operator">(</div><div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">,</div> <div class="ident">len</div><div class="operator">(</div><div class="ident">initStatements</div><div class="operator">)</div><div class="operator">&#43;</div><div class="ident">len</div><div class="operator">(</div><div class="ident">indexStatements</div><div class="operator">)</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>add all init statements</p>
</td>
	<td class="code"><pre><code>				<div class="ident">sqlStatements</div> <div class="operator">=</div> <div class="ident">append</div><div class="operator">(</div><div class="ident">sqlStatements</div><div class="operator">,</div> <div class="ident">initStatements</div><div class="operator">...</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>add all statements to create indices</p>
</td>
	<td class="code"><pre><code>				<div class="ident">sqlStatements</div> <div class="operator">=</div> <div class="ident">append</div><div class="operator">(</div><div class="ident">sqlStatements</div><div class="operator">,</div> <div class="ident">indexStatements</div><div class="operator">...</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>now everything's ready -&gt; run benchmark</p>
</td>
	<td class="code"><pre><code>				<div class="ident">runBenchmarkSelectOrDeleteFromReportedTable</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">insertFunction</div><div class="operator">,</div>
					<div class="ident">selectStatement</div><div class="operator">,</div> <div class="ident">deleteStatement</div><div class="operator">,</div>
					<div class="ident">sqlStatements</div><div class="operator">,</div> <div class="ident">reportsCount</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">report</div><div class="operator">)</div><div class="operator"></div>
			<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
		<div class="operator">}</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>computeLength function calculates correct length of slice with values in
range &lt;min, max) with given step</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">computeLength</div><div class="operator">(</div><div class="ident">min</div><div class="operator">,</div> <div class="ident">max</div><div class="operator">,</div> <div class="ident">step</div> <div class="ident">int</div><div class="operator">)</div> <div class="ident">int</div> <div class="operator">{</div>
	<div class="ident">diff</div> <div class="operator">:=</div> <div class="ident">max</div> <div class="operator">-</div> <div class="ident">min</div><div class="operator"></div>
	<div class="ident">length</div> <div class="operator">:=</div> <div class="ident">diff</div> <div class="operator">/</div> <div class="ident">step</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>poor man's integer ceiling</p>
</td>
	<td class="code"><pre><code>	<div class="keyword">if</div> <div class="ident">diff</div><div class="operator">%</div><div class="ident">step</div> <div class="operator">!=</div> <div class="literal">0</div> <div class="operator">{</div>
		<div class="ident">length</div><div class="operator">&#43;&#43;</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>
	<div class="keyword">return</div> <div class="ident">length</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>parseReportsCount tries to parse -reports-count parameter that have following format:
-reports-count=1,2,5</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">parseReportsCount</div><div class="operator">(</div><div class="ident">param</div> <div class="ident">string</div><div class="operator">)</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">int</div> <div class="operator">{</div>
	<div class="keyword">var</div> <div class="ident">count</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">int</div> <div class="operator">=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">int</div><div class="operator">{</div><div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>split the string first</p>
</td>
	<td class="code"><pre><code>	<div class="ident">parts</div> <div class="operator">:=</div> <div class="ident">strings</div><div class="operator">.</div><div class="ident">Split</div><div class="operator">(</div><div class="ident">param</div><div class="operator">,</div> <div class="literal">&#34;,&#34;</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>now try to parse parts sequentially</p>
</td>
	<td class="code"><pre><code>	<div class="keyword">for</div> <div class="ident">_</div><div class="operator">,</div> <div class="ident">part</div> <div class="operator">:=</div> <div class="keyword">range</div> <div class="ident">parts</div> <div class="operator">{</div>
		<div class="ident">value</div><div class="operator">,</div> <div class="ident">err</div> <div class="operator">:=</div> <div class="ident">strconv</div><div class="operator">.</div><div class="ident">Atoi</div><div class="operator">(</div><div class="ident">part</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>skip problematic part</p>
</td>
	<td class="code"><pre><code>		<div class="keyword">if</div> <div class="ident">err</div> <div class="operator">!=</div> <div class="ident">nil</div> <div class="operator">{</div>
			<div class="keyword">continue</div><div class="operator"></div>
		<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>append parsed value</p>
</td>
	<td class="code"><pre><code>		<div class="ident">count</div> <div class="operator">=</div> <div class="ident">append</div><div class="operator">(</div><div class="ident">count</div><div class="operator">,</div> <div class="ident">value</div><div class="operator">)</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>

	<div class="keyword">return</div> <div class="ident">count</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>readPossibleReportsCount read sequence of # reports to be inserted into
tested table.</p>

<p>It is based on following CLI flags:
-min-reports=1 -max-reports=10 -reports-step=2 -reports-count=1,2,5</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">readPossibleReportsCount</div><div class="operator">(</div><div class="operator">)</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">int</div> <div class="operator">{</div>
	<div class="keyword">if</div> <div class="operator">*</div><div class="ident">reportsCountParam</div> <div class="operator">!=</div> <div class="literal">&#34;&#34;</div> <div class="operator">{</div>
		<div class="keyword">return</div> <div class="ident">parseReportsCount</div><div class="operator">(</div><div class="operator">*</div><div class="ident">reportsCountParam</div><div class="operator">)</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>check if CLI flags are specified</p>
</td>
	<td class="code"><pre><code>	<div class="keyword">if</div> <div class="ident">minReportsParam</div> <div class="operator">==</div> <div class="ident">nil</div> <div class="operator">||</div> <div class="ident">maxReportsParam</div> <div class="operator">==</div> <div class="ident">nil</div> <div class="operator">||</div> <div class="ident">reportsStepParam</div> <div class="operator">==</div> <div class="ident">nil</div> <div class="operator">{</div>
		<div class="keyword">var</div> <div class="ident">defaultCounts</div> <div class="operator">=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">int</div><div class="operator">{</div><div class="literal">1</div><div class="operator">,</div> <div class="literal">10</div><div class="operator">,</div> <div class="literal">100</div><div class="operator">,</div> <div class="literal">1000</div><div class="operator">}</div><div class="operator"></div>
		<div class="keyword">return</div> <div class="ident">defaultCounts</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>make slice to store all reports count</p>
</td>
	<td class="code"><pre><code>	<div class="ident">length</div> <div class="operator">:=</div> <div class="ident">computeLength</div><div class="operator">(</div><div class="operator">*</div><div class="ident">minReportsParam</div><div class="operator">,</div> <div class="operator">*</div><div class="ident">maxReportsParam</div><div class="operator">,</div> <div class="operator">*</div><div class="ident">reportsStepParam</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">var</div> <div class="ident">counts</div> <div class="operator">=</div> <div class="ident">make</div><div class="operator">(</div><div class="operator">[</div><div class="operator">]</div><div class="ident">int</div><div class="operator">,</div> <div class="ident">length</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>fill-in the slice with correct values</p>
</td>
	<td class="code"><pre><code>	<div class="ident">count</div> <div class="operator">:=</div> <div class="operator">*</div><div class="ident">minReportsParam</div><div class="operator"></div>
	<div class="keyword">for</div> <div class="ident">i</div> <div class="operator">:=</div> <div class="literal">0</div><div class="operator">;</div> <div class="ident">i</div> <div class="operator">&lt;</div> <div class="ident">length</div><div class="operator">;</div> <div class="ident">i</div><div class="operator">&#43;&#43;</div> <div class="operator">{</div>
		<div class="ident">counts</div><div class="operator">[</div><div class="ident">i</div><div class="operator">]</div> <div class="operator">=</div> <div class="ident">count</div><div class="operator"></div>
		<div class="ident">count</div> <div class="operator">&#43;=</div> <div class="operator">*</div><div class="ident">reportsStepParam</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>

	<div class="keyword">return</div> <div class="ident">counts</div><div class="operator"></div>

<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkInsertReportsIntoReportedTableV1 checks the speed of inserting
into reported table without event_type column</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkInsertReportsIntoReportedTableV1</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>try to insert empty reports</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="literal">&#34;&#34;</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV1</div><div class="operator">,</div>
		<div class="ident">createTableReportedV1</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV1</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkInsertReportsIntoReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">insertIntoReportedV1</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkInsertReportsIntoReportedTableV2 checks the speed of inserting
into reported table with event_type column</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkInsertReportsIntoReportedTableV2</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>try to insert empty reports</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="literal">&#34;&#34;</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table with event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV2</div><div class="operator">,</div>
		<div class="ident">createTableReportedV2</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table with event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV2</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkInsertReportsIntoReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">insertIntoReportedV2</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkInsertAnalysisMetadataOnlyReportIntoReportedTableV1 checks the speed of inserting
into reported table without event_type column</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkInsertAnalysisMetadataOnlyReportIntoReportedTableV1</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>report with size approx 0.5kB</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="ident">readReport</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">reportWithAnalysisMetadataOnlyInJSON</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV1</div><div class="operator">,</div>
		<div class="ident">createTableReportedV1</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV1</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkInsertReportsIntoReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">insertIntoReportedV1</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkInsertAnalysisMetadataOnlyReportIntoReportedTableV2 checks the speed of inserting
into reported table with event_type column</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkInsertAnalysisMetadataOnlyReportIntoReportedTableV2</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>report with size approx 0.5kB</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="ident">readReport</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">reportWithAnalysisMetadataOnlyInJSON</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table with event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV2</div><div class="operator">,</div>
		<div class="ident">createTableReportedV2</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table with event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV2</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkInsertReportsIntoReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">insertIntoReportedV2</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkInsertSmallReportIntoReportedTableV1 checks the speed of inserting
into reported table without event_type column</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkInsertSmallReportIntoReportedTableV1</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>report with size approx 2kB</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="ident">readReport</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">smallReportInJSON</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV1</div><div class="operator">,</div>
		<div class="ident">createTableReportedV1</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV1</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkInsertReportsIntoReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">insertIntoReportedV1</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkInsertSmallReportIntoReportedTableV2 checks the speed of inserting
into reported table with event_type column</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkInsertSmallReportIntoReportedTableV2</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>report with size approx 2kB</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="ident">readReport</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">smallReportInJSON</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table with event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV2</div><div class="operator">,</div>
		<div class="ident">createTableReportedV2</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table with event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV2</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkInsertReportsIntoReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">insertIntoReportedV2</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkInsertMiddleReportIntoReportedTableV1 checks the speed of inserting
into reported table without event_type column</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkInsertMiddleReportIntoReportedTableV1</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>report with size approx 4kB</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="ident">readReport</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">middleReportInJSON</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV1</div><div class="operator">,</div>
		<div class="ident">createTableReportedV1</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV1</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkInsertReportsIntoReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">insertIntoReportedV1</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkInsertMiddleReportIntoReportedTableV2 checks the speed of inserting
into reported table with event_type column</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkInsertMiddleReportIntoReportedTableV2</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>report with size approx 4kB</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="ident">readReport</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">middleReportInJSON</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table with event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV2</div><div class="operator">,</div>
		<div class="ident">createTableReportedV2</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table with event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV2</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkInsertReportsIntoReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">insertIntoReportedV2</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkInsertLargeReportIntoReportedTableV1 checks the speed of inserting
into reported table without event_type column</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkInsertLargeReportIntoReportedTableV1</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>report with size over 8kB</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="ident">readReport</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">largeReportInJSON</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV1</div><div class="operator">,</div>
		<div class="ident">createTableReportedV1</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV1</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkInsertReportsIntoReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">insertIntoReportedV1</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkInsertLargeReportIntoReportedTableV2 checks the speed of inserting
into reported table with event_type column</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkInsertLargeReportIntoReportedTableV2</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>report with size over 8kB</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="ident">readReport</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">largeReportInJSON</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table with event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV2</div><div class="operator">,</div>
		<div class="ident">createTableReportedV2</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table with event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV2</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkInsertReportsIntoReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">insertIntoReportedV2</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkSelectOldEmptyRecordsFromReportedTableV1 tests the query to reported
table used inside CCX Notification Service</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkSelectOldEmptyRecordsFromReportedTableV1</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>empty report</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="literal">``</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV1</div><div class="operator">,</div>
		<div class="ident">createTableReportedV1</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV1</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>read number of reports to be inserted into the table under tests</p>
</td>
	<td class="code"><pre><code>	<div class="ident">reportsCount</div> <div class="operator">:=</div> <div class="ident">readPossibleReportsCount</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkSelectOrDeleteOldReportsFromReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div>
		<div class="ident">insertIntoReportedV1</div><div class="operator">,</div> <div class="ident">displayOldRecordsFromReportedTableV1</div><div class="operator">,</div> <div class="ident">noOpStatement</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">,</div> <div class="ident">reportsCount</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkSelectOldEmptyRecordsFromReportedTableV2 tests the query to reported
table used inside CCX Notification Service</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkSelectOldEmptyRecordsFromReportedTableV2</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>empty report</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="literal">``</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table with event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV2</div><div class="operator">,</div>
		<div class="ident">createTableReportedV2</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV2</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>read number of reports to be inserted into the table under tests</p>
</td>
	<td class="code"><pre><code>	<div class="ident">reportsCount</div> <div class="operator">:=</div> <div class="ident">readPossibleReportsCount</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkSelectOrDeleteOldReportsFromReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div>
		<div class="ident">insertIntoReportedV2</div><div class="operator">,</div> <div class="ident">displayOldRecordsFromReportedTableV2</div><div class="operator">,</div> <div class="ident">noOpStatement</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">,</div> <div class="ident">reportsCount</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkSelectOldSmallRecordsFromReportedTableV1 tests the query to reported
table used inside CCX Notification Service</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkSelectOldSmallRecordsFromReportedTableV1</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>report with size over 2kB</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="ident">readReport</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">smallReportInJSON</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV1</div><div class="operator">,</div>
		<div class="ident">createTableReportedV1</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV1</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>read number of reports to be inserted into the table under tests</p>
</td>
	<td class="code"><pre><code>	<div class="ident">reportsCount</div> <div class="operator">:=</div> <div class="ident">readPossibleReportsCount</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkSelectOrDeleteOldReportsFromReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div>
		<div class="ident">insertIntoReportedV1</div><div class="operator">,</div> <div class="ident">displayOldRecordsFromReportedTableV1</div><div class="operator">,</div> <div class="ident">noOpStatement</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">,</div> <div class="ident">reportsCount</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkSelectOldSmallRecordsFromReportedTableV2 tests the query to reported
table used inside CCX Notification Service</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkSelectOldSmallRecordsFromReportedTableV2</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>report with size over 2kB</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="ident">readReport</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">smallReportInJSON</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table with event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV2</div><div class="operator">,</div>
		<div class="ident">createTableReportedV2</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV2</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>read number of reports to be inserted into the table under tests</p>
</td>
	<td class="code"><pre><code>	<div class="ident">reportsCount</div> <div class="operator">:=</div> <div class="ident">readPossibleReportsCount</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkSelectOrDeleteOldReportsFromReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div>
		<div class="ident">insertIntoReportedV2</div><div class="operator">,</div> <div class="ident">displayOldRecordsFromReportedTableV2</div><div class="operator">,</div> <div class="ident">noOpStatement</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">,</div> <div class="ident">reportsCount</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkSelectOldMiddleRecordsFromReportedTableV1 tests the query to reported
table used inside CCX Notification Service</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkSelectOldMiddleRecordsFromReportedTableV1</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>report with size over 4kB</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="ident">readReport</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">middleReportInJSON</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV1</div><div class="operator">,</div>
		<div class="ident">createTableReportedV1</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV1</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>read number of reports to be inserted into the table under tests</p>
</td>
	<td class="code"><pre><code>	<div class="ident">reportsCount</div> <div class="operator">:=</div> <div class="ident">readPossibleReportsCount</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkSelectOrDeleteOldReportsFromReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div>
		<div class="ident">insertIntoReportedV1</div><div class="operator">,</div> <div class="ident">displayOldRecordsFromReportedTableV1</div><div class="operator">,</div> <div class="ident">noOpStatement</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">,</div> <div class="ident">reportsCount</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkSelectOldMiddleRecordsFromReportedTableV2 tests the query to reported
table used inside CCX Notification Service</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkSelectOldMiddleRecordsFromReportedTableV2</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>report with size over 4kB</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="ident">readReport</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">middleReportInJSON</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table with event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV2</div><div class="operator">,</div>
		<div class="ident">createTableReportedV2</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV2</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>read number of reports to be inserted into the table under tests</p>
</td>
	<td class="code"><pre><code>	<div class="ident">reportsCount</div> <div class="operator">:=</div> <div class="ident">readPossibleReportsCount</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkSelectOrDeleteOldReportsFromReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div>
		<div class="ident">insertIntoReportedV2</div><div class="operator">,</div> <div class="ident">displayOldRecordsFromReportedTableV2</div><div class="operator">,</div> <div class="ident">noOpStatement</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">,</div> <div class="ident">reportsCount</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkSelectOldLargeRecordsFromReportedTableV1 tests the query to reported
table used inside CCX Notification Service</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkSelectOldLargeRecordsFromReportedTableV1</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>report with size over 8kB</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="ident">readReport</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">largeReportInJSON</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV1</div><div class="operator">,</div>
		<div class="ident">createTableReportedV1</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV1</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>read number of reports to be inserted into the table under tests</p>
</td>
	<td class="code"><pre><code>	<div class="ident">reportsCount</div> <div class="operator">:=</div> <div class="ident">readPossibleReportsCount</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkSelectOrDeleteOldReportsFromReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div>
		<div class="ident">insertIntoReportedV1</div><div class="operator">,</div> <div class="ident">displayOldRecordsFromReportedTableV1</div><div class="operator">,</div> <div class="ident">noOpStatement</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">,</div> <div class="ident">reportsCount</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkSelectOldLargeRecordsFromReportedTableV2 tests the query to reported
table used inside CCX Notification Service</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkSelectOldLargeRecordsFromReportedTableV2</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>report with size over 8kB</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="ident">readReport</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">largeReportInJSON</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table with event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV2</div><div class="operator">,</div>
		<div class="ident">createTableReportedV2</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV2</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>read number of reports to be inserted into the table under tests</p>
</td>
	<td class="code"><pre><code>	<div class="ident">reportsCount</div> <div class="operator">:=</div> <div class="ident">readPossibleReportsCount</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkSelectOrDeleteOldReportsFromReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div>
		<div class="ident">insertIntoReportedV2</div><div class="operator">,</div> <div class="ident">displayOldRecordsFromReportedTableV2</div><div class="operator">,</div> <div class="ident">noOpStatement</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">,</div> <div class="ident">reportsCount</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkDeleteOldEmptyRecordsFromReportedTableV1 tests the deletion statement
from reported table used inside CCX Notification Service</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkDeleteOldEmptyRecordsFromReportedTableV1</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>empty report</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="literal">``</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV1</div><div class="operator">,</div>
		<div class="ident">createTableReportedV1</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV1</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>read number of reports to be inserted into the table under tests</p>
</td>
	<td class="code"><pre><code>	<div class="ident">reportsCount</div> <div class="operator">:=</div> <div class="ident">readPossibleReportsCount</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkSelectOrDeleteOldReportsFromReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div>
		<div class="ident">insertIntoReportedV1</div><div class="operator">,</div> <div class="ident">noOpStatement</div><div class="operator">,</div> <div class="ident">deleteOldRecordsFromReportedTableV1</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">,</div> <div class="ident">reportsCount</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkDeleteOldEmptyRecordsFromReportedTableV2 tests the deletion statement
from reported table used inside CCX Notification Service</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkDeleteOldEmptyRecordsFromReportedTableV2</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>empty report</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="literal">``</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV2</div><div class="operator">,</div>
		<div class="ident">createTableReportedV2</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV2</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>read number of reports to be inserted into the table under tests</p>
</td>
	<td class="code"><pre><code>	<div class="ident">reportsCount</div> <div class="operator">:=</div> <div class="ident">readPossibleReportsCount</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkSelectOrDeleteOldReportsFromReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div>
		<div class="ident">insertIntoReportedV2</div><div class="operator">,</div> <div class="ident">noOpStatement</div><div class="operator">,</div> <div class="ident">deleteOldRecordsFromReportedTableV2</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">,</div> <div class="ident">reportsCount</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkDeleteOldSmallRecordsFromReportedTableV1 tests the deletion statement
from reported table used inside CCX Notification Service</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkDeleteOldSmallRecordsFromReportedTableV1</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>report with size over 2kB</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="ident">readReport</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">smallReportInJSON</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV1</div><div class="operator">,</div>
		<div class="ident">createTableReportedV1</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV1</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>read number of reports to be inserted into the table under tests</p>
</td>
	<td class="code"><pre><code>	<div class="ident">reportsCount</div> <div class="operator">:=</div> <div class="ident">readPossibleReportsCount</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkSelectOrDeleteOldReportsFromReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div>
		<div class="ident">insertIntoReportedV1</div><div class="operator">,</div> <div class="ident">noOpStatement</div><div class="operator">,</div> <div class="ident">deleteOldRecordsFromReportedTableV1</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">,</div> <div class="ident">reportsCount</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkDeleteOldSmallRecordsFromReportedTableV2 tests the deletion statement
from reported table used inside CCX Notification Service</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkDeleteOldSmallRecordsFromReportedTableV2</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>report with size over 2kB</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="ident">readReport</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">smallReportInJSON</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV2</div><div class="operator">,</div>
		<div class="ident">createTableReportedV2</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV2</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>read number of reports to be inserted into the table under tests</p>
</td>
	<td class="code"><pre><code>	<div class="ident">reportsCount</div> <div class="operator">:=</div> <div class="ident">readPossibleReportsCount</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkSelectOrDeleteOldReportsFromReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div>
		<div class="ident">insertIntoReportedV2</div><div class="operator">,</div> <div class="ident">noOpStatement</div><div class="operator">,</div> <div class="ident">deleteOldRecordsFromReportedTableV2</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">,</div> <div class="ident">reportsCount</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkDeleteOldMiddleRecordsFromReportedTableV1 tests the deletion statement
from reported table used inside CCX Notification Service</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkDeleteOldMiddleRecordsFromReportedTableV1</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>report with size over 4kB</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="ident">readReport</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">middleReportInJSON</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV1</div><div class="operator">,</div>
		<div class="ident">createTableReportedV1</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV1</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>read number of reports to be inserted into the table under tests</p>
</td>
	<td class="code"><pre><code>	<div class="ident">reportsCount</div> <div class="operator">:=</div> <div class="ident">readPossibleReportsCount</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkSelectOrDeleteOldReportsFromReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div>
		<div class="ident">insertIntoReportedV1</div><div class="operator">,</div> <div class="ident">noOpStatement</div><div class="operator">,</div> <div class="ident">deleteOldRecordsFromReportedTableV1</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">,</div> <div class="ident">reportsCount</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkDeleteOldMiddleRecordsFromReportedTableV2 tests the deletion statement
from reported table used inside CCX Notification Service</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkDeleteOldMiddleRecordsFromReportedTableV2</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>report with size over 4kB</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="ident">readReport</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">middleReportInJSON</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV2</div><div class="operator">,</div>
		<div class="ident">createTableReportedV2</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV2</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>read number of reports to be inserted into the table under tests</p>
</td>
	<td class="code"><pre><code>	<div class="ident">reportsCount</div> <div class="operator">:=</div> <div class="ident">readPossibleReportsCount</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkSelectOrDeleteOldReportsFromReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div>
		<div class="ident">insertIntoReportedV2</div><div class="operator">,</div> <div class="ident">noOpStatement</div><div class="operator">,</div> <div class="ident">deleteOldRecordsFromReportedTableV2</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">,</div> <div class="ident">reportsCount</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkDeleteOldLargeRecordsFromReportedTableV1 tests the deletion statement
from reported table used inside CCX Notification Service</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkDeleteOldLargeRecordsFromReportedTableV1</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>report with size over 8kB</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="ident">readReport</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">largeReportInJSON</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV1</div><div class="operator">,</div>
		<div class="ident">createTableReportedV1</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV1</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>read number of reports to be inserted into the table under tests</p>
</td>
	<td class="code"><pre><code>	<div class="ident">reportsCount</div> <div class="operator">:=</div> <div class="ident">readPossibleReportsCount</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkSelectOrDeleteOldReportsFromReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div>
		<div class="ident">insertIntoReportedV1</div><div class="operator">,</div> <div class="ident">noOpStatement</div><div class="operator">,</div> <div class="ident">deleteOldRecordsFromReportedTableV1</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">,</div> <div class="ident">reportsCount</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>BenchmarkDeleteOldLargeRecordsFromReportedTableV2 tests the deletion statement
from reported table used inside CCX Notification Service</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">BenchmarkDeleteOldLargeRecordsFromReportedTableV2</div><div class="operator">(</div><div class="ident">b</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">B</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>report with size over 8kB</p>
</td>
	<td class="code"><pre><code>	<div class="ident">report</div> <div class="operator">:=</div> <div class="ident">readReport</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div> <div class="ident">largeReportInJSON</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>default init statements for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">initStatements</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">string</div><div class="operator">{</div>
		<div class="ident">dropTableReportedV2</div><div class="operator">,</div>
		<div class="ident">createTableReportedV2</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>all possible indices combinatiors for reported table without event<em>type</em>id column</p>
</td>
	<td class="code"><pre><code>	<div class="ident">indices</div> <div class="operator">:=</div> <div class="ident">getIndicesForReportedTableV2</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>read number of reports to be inserted into the table under tests</p>
</td>
	<td class="code"><pre><code>	<div class="ident">reportsCount</div> <div class="operator">:=</div> <div class="ident">readPossibleReportsCount</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>run benchmarks with various combination of indices</p>
</td>
	<td class="code"><pre><code>	<div class="ident">benchmarkSelectOrDeleteOldReportsFromReportedTableImpl</div><div class="operator">(</div><div class="ident">b</div><div class="operator">,</div>
		<div class="ident">insertIntoReportedV2</div><div class="operator">,</div> <div class="ident">noOpStatement</div><div class="operator">,</div> <div class="ident">deleteOldRecordsFromReportedTableV2</div><div class="operator">,</div>
		<div class="ident">initStatements</div><div class="operator">,</div> <div class="ident">indices</div><div class="operator">,</div> <div class="ident">report</div><div class="operator">,</div> <div class="ident">reportsCount</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
    </tbody>
  </table>
</div>
</body>
</html>
